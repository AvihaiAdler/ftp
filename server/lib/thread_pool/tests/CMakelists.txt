set(THREADPOOL_UNIT_TESTS thread_pool_sanity_simple thread_pool_sanity)

foreach(test ${THREADPOOL_UNIT_TESTS})
  add_executable(${test})
  target_sources(${test}
    PRIVATE ${test}.c
  )

  add_test(NAME ${test} COMMAND $<TARGET_FILE:${test}>)

  target_compile_features(${test}
    PRIVATE c_std_11
  )

  target_compile_definitions(${test}
    PRIVATE -D_XOPEN_SOURCE=700
  )

  target_compile_options(${test}
    PRIVATE
    -Wall
    -Wextra
    -Wpedantic
    -Og
    -g
    -fsanitize=address,undefined
  )

  target_link_options(${test}
    PRIVATE
    -fsanitize=address,undefined
  )

  target_link_libraries(${test}
    PRIVATE thread_pool
    PRIVATE logger
  )
endforeach()
